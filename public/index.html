<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vercel ä»£ç†æµ‹è¯•å™¨</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f4f4f5; color: #333; }
        .card { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        h1 { margin-top: 0; color: #0070f3; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { background: #0070f3; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; font-size: 16px; transition: background 0.2s; }
        button:hover { background: #0051a2; }
        pre { background: #111; color: #50fa7b; padding: 15px; border-radius: 4px; overflow-x: auto; min-height: 100px; }
        .status { margin-top: 10px; font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <div class="card">
        <h1>ğŸŒ Vercel é€šç”¨ API ä»£ç†</h1>
        <p>è¾“å…¥ä¸€ä¸ªå›½å¤– API åœ°å€æˆ–ç½‘é¡µåœ°å€è¿›è¡Œæµ‹è¯•ã€‚</p>
        
        <div class="input-group">
            <label>ç›®æ ‡ URL (ä¾‹å¦‚: https://www.google.com)</label>
            <input type="text" id="targetUrl" placeholder="https://api.github.com/users/vercel" value="https://api.github.com/users/vercel">
        </div>

        <div class="input-group">
            <label>è¯·æ±‚æ–¹æ³•</label>
            <select id="method">
                <option value="GET">GET</option>
                <option value="POST">POST</option>
            </select>
        </div>

        <button onclick="testProxy()">å‘é€è¯·æ±‚</button>

        <div class="status" id="status"></div>
        
        <h3>å“åº”ç»“æœ:</h3>
        <pre id="result">// ç­‰å¾…è¯·æ±‚...</pre>
    </div>

    <script>
        async function testProxy() {
            const target = document.getElementById('targetUrl').value;
            const method = document.getElementById('method').value;
            const resultBox = document.getElementById('result');
            const statusBox = document.getElementById('status');

            if (!target) {
                alert('è¯·è¾“å…¥ç›®æ ‡ URL');
                return;
            }

            // æ„å»ºä»£ç† URL
            // æ³¨æ„ï¼šåœ¨æœ¬åœ°æ‰“å¼€æ­¤ HTML æ—¶ï¼Œä½ éœ€è¦éƒ¨ç½²å¥½ Vercel åå°†ä¸‹é¢çš„ /api æ›¿æ¢ä¸ºä½ çš„ Vercel åŸŸå
            // å¦‚æœæ­¤æ–‡ä»¶éƒ¨ç½²åœ¨åŒä¸€ä¸ª Vercel é¡¹ç›®ä¸‹ï¼Œç›´æ¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„å³å¯
            const proxyUrl = `/api/index?url=${encodeURIComponent(target)}`;
            
            statusBox.textContent = `æ­£åœ¨é€šè¿‡ä»£ç†è¯·æ±‚: ${target}...`;
            resultBox.textContent = "Loading...";

            try {
                const startTime = Date.now();
                const response = await fetch(proxyUrl, {
                    method: method,
                    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªå®šä¹‰ Header æµ‹è¯•
                });

                const endTime = Date.now();
                const contentType = response.headers.get('content-type');
                
                let data;
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                    data = JSON.stringify(data, null, 2);
                } else {
                    data = await response.text();
                    // ç®€å•çš„æˆªæ–­ï¼Œé˜²æ­¢ç½‘é¡µ HTML å¤ªé•¿
                    if(data.length > 2000) data = data.substring(0, 2000) + "\n... (å†…å®¹è¿‡é•¿å·²æˆªæ–­)";
                }

                statusBox.textContent = `çŠ¶æ€ç : ${response.status} | è€—æ—¶: ${endTime - startTime}ms`;
                resultBox.textContent = data;
            } catch (err) {
                statusBox.textContent = "è¯·æ±‚å¤±è´¥";
                resultBox.textContent = "é”™è¯¯: " + err.message + "\n\nè¯·ç¡®ä¿ä½ å·²å°†é¡¹ç›®éƒ¨ç½²åˆ° Vercelã€‚";
            }
        }
    </script>
</body>
</html>